/**
 * 취약점 심각도 레벨
 */
export type Severity = "critical" | "high" | "medium" | "low";

/**
 * 취약점 심각도 + safe 포함
 */
export type SeverityWithSafe = Severity | "safe";

/**
 * 단일 취약점 정보
 */
export interface Vulnerability {
  /** 취약점 ID (예: "GHSA-xxxx-xxxx", "CVE-2021-xxxx") */
  id: string;
  /** 심각도 */
  severity: Severity;
  /** 취약점 제목 */
  title: string;
  /** 취약점 설명 */
  description?: string;
  /** 영향받는 버전 범위 */
  affectedVersions: string;
  /** 수정된 버전 (없으면 undefined) */
  fixedVersion?: string;
  /** 참조 URL */
  referenceUrl?: string;
}

/**
 * 패키지별 취약점 정보
 */
export interface PackageVulnerability {
  /** 패키지명 */
  packageName: string;
  /** 설치된 버전 */
  version: string;
  /** 발견된 취약점 목록 */
  vulnerabilities: Vulnerability[];
  /** 최대 심각도 (취약점 없으면 "safe") */
  maxSeverity: SeverityWithSafe;
}

/**
 * 취약점 분석 결과
 */
export interface VulnerabilityAnalysisResult {
  /** 분석된 패키지 목록 */
  packages: PackageVulnerability[];
  /** 심각도별 패키지 수 */
  summary: {
    critical: number;
    high: number;
    medium: number;
    low: number;
    safe: number;
  };
  /** 전체 취약점 수 */
  totalVulnerabilities: number;
}
