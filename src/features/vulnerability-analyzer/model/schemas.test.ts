import { describe, it, expect } from "vitest";
import { cvssToSeverity, osvSeverityToSeverity } from "./schemas";

describe("cvssToSeverity", () => {
  it("9.0 이상은 critical", () => {
    expect(cvssToSeverity(9.0)).toBe("critical");
    expect(cvssToSeverity(10.0)).toBe("critical");
    expect(cvssToSeverity(9.5)).toBe("critical");
  });

  it("7.0-8.9는 high", () => {
    expect(cvssToSeverity(7.0)).toBe("high");
    expect(cvssToSeverity(8.9)).toBe("high");
    expect(cvssToSeverity(8.0)).toBe("high");
  });

  it("4.0-6.9는 medium", () => {
    expect(cvssToSeverity(4.0)).toBe("medium");
    expect(cvssToSeverity(6.9)).toBe("medium");
    expect(cvssToSeverity(5.5)).toBe("medium");
  });

  it("4.0 미만은 low", () => {
    expect(cvssToSeverity(3.9)).toBe("low");
    expect(cvssToSeverity(0.1)).toBe("low");
    expect(cvssToSeverity(2.0)).toBe("low");
  });
});

describe("osvSeverityToSeverity", () => {
  it("CVSS 점수 문자열을 변환", () => {
    expect(osvSeverityToSeverity("9.5")).toBe("critical");
    expect(osvSeverityToSeverity("7.2")).toBe("high");
    expect(osvSeverityToSeverity("5.0")).toBe("medium");
    expect(osvSeverityToSeverity("2.5")).toBe("low");
  });

  it("심각도 문자열을 변환", () => {
    expect(osvSeverityToSeverity("CRITICAL")).toBe("critical");
    expect(osvSeverityToSeverity("High")).toBe("high");
    expect(osvSeverityToSeverity("MODERATE")).toBe("medium");
    expect(osvSeverityToSeverity("low")).toBe("low");
  });

  it("undefined는 medium 반환", () => {
    expect(osvSeverityToSeverity(undefined)).toBe("medium");
  });

  it("알 수 없는 문자열은 medium 반환", () => {
    expect(osvSeverityToSeverity("unknown")).toBe("medium");
  });
});
