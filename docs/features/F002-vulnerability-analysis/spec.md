# Feature Spec: 취약점 분석

## 개요

- **기능 ID**: F002
- **기능명**: vulnerability-analysis
- **작성일**: 2025-12-24
- **상태**: Draft
- **GitHub Issue**: [#5](https://github.com/leey00nsu/dependenga/issues/5)

---

## 목적

파싱된 의존성 패키지들의 보안 취약점 정보를 조회하여 사용자에게 위험도를 시각적으로 알려줍니다. 이 정보는 3D 젠가 시각화에서 블록 색상의 기반이 됩니다.

---

## 사용자 스토리

### US-1: 의존성별 취약점 조회

**As a** 개발자  
**I want** 프로젝트 의존성의 취약점 정보를 한눈에 보기를  
**So that** 보안 위험을 빠르게 파악할 수 있습니다.

**Acceptance Criteria:**
- [ ] 각 패키지별 취약점 개수 표시
- [ ] 심각도별 분류 (critical, high, medium, low)
- [ ] 취약점이 없는 패키지는 safe로 표시

### US-2: 취약점 상세 정보

**As a** 개발자  
**I want** 취약점의 상세 정보를 확인하기를  
**So that** 적절한 조치를 취할 수 있습니다.

**Acceptance Criteria:**
- [ ] 취약점 제목/설명 표시
- [ ] 영향받는 버전 범위 표시
- [ ] 수정된 버전 정보 (있는 경우)

---

## 기능 요구사항

### FR-1: 취약점 데이터 소스

- npm audit 또는 GitHub Advisory Database 사용
- OSV (Open Source Vulnerabilities) API 우선 검토
  - 공개 API, 인증 불필요
  - npm 생태계 지원
  - URL: `https://api.osv.dev/v1/query`

### FR-2: 취약점 정보 구조

```typescript
interface Vulnerability {
  id: string;              // 예: "GHSA-xxxx-xxxx"
  severity: "critical" | "high" | "medium" | "low";
  title: string;
  description?: string;
  affectedVersions: string;
  fixedVersion?: string;
}

interface PackageVulnerability {
  packageName: string;
  version: string;
  vulnerabilities: Vulnerability[];
  maxSeverity: "critical" | "high" | "medium" | "low" | "safe";
}
```

### FR-3: 심각도 분류

| 레벨 | 색상 | CVSS 점수 |
|------|------|-----------|
| critical | 빨강 | 9.0 - 10.0 |
| high | 주황 | 7.0 - 8.9 |
| medium | 노랑 | 4.0 - 6.9 |
| low | 연두 | 0.1 - 3.9 |
| safe | 초록 | 취약점 없음 |

---

## 비기능 요구사항

- **성능**: 전체 의존성 취약점 조회 5초 이내
- **캐싱**: 동일 패키지/버전은 캐싱하여 중복 조회 방지
- **Rate Limiting**: OSV API 호출 제한 준수

---

## 엣지 케이스

- 패키지가 npm registry에 없는 경우
- scoped package (@org/package)
- pre-release 버전 (1.0.0-beta.1)
- 범위 버전 명시 (^1.0.0, ~2.0.0)

---

## 스펙 외 (Out of Scope)

- 취약점 자동 수정 제안
- lock 파일 분석 (중첩 의존성)
- 실시간 모니터링/알림

---

## 관련 문서

- PRD: [dependenga-prd.md](../../prd/dependenga-prd.md)
- 이전 기능: F001-dependency-parser
- 다음 기능: F003-3d-visualization
